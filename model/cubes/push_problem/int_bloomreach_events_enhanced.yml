{% set model = dbt_model('int_bloomreach_events_enhanced') %}
 
cubes:
  - {{ model.as_cube() }}

    joins:
    - name: int_af_id
      sql: "${CUBE.user_id} = ${int_af_id.user_id}"
      relationship: one_to_one

    dimensions:
      {{ model.as_dimensions() }}
      - name: user_id
        sql: user_id
        primary_key: true
        type: number
      - name: appsflyer_id
        sql: ${int_af_id.appsflyer_id}
        type: string      
 
    measures:
      - name: count
        type: count
      - name: distinct_users
        type: count_distinct
        sql: user_id
  